q = 5 # Number of nodes
q = 5 # Number of nodes
indepTest = gaussCItest
source("~/GitHub/BSProject2526/test/data_simulator.R", echo = TRUE)
source("~/GitHub/BSProject2526/test/main_simulation_1.R", echo = TRUE)
source("~/GitHub/BSProject2526/test/main_simulation_1.R", echo = TRUE)
source("~/GitHub/BSProject2526/test/main_simulation_1.R", echo = TRUE)
library(BiocGenerics)
source("~/GitHub/BSProject2526/test/main_simulation_1.R", echo = TRUE)
source("~/GitHub/BSProject2526/test/main_simulation_1.R", echo = TRUE)
source("~/GitHub/BSProject2526/test/main_simulation_1.R", echo = TRUE)
source("~/GitHub/BSProject2526/test/main_simulation_1.R", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
install.packages("varbvs")
#install.packages("hdi")
install.packages("varbvs")
data(riboflavin)
help(data("riboflavin"))
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
dim(X_red)
sel_pip
# Selezione delle covariate con posterior probability più alta di 0.5, oppure, se queste ultime sono poche, teniamo le prime 200
sel_pip <- names(pip)[pip > 0.4]          # soglia "mediana" classica
sel_pip
# Selezione delle covariate con posterior probability più alta di 0.5, oppure, se queste ultime sono poche, teniamo le prime 200
sel_pip <- names(pip)[pip > 0.3]          # soglia "mediana" classica
sel_pip
source("~/.active-rstudio-document", echo = TRUE)
sel_pip
pip
sel_pip
install.packages("rstanarm")
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
B <- post[, !colnames(post) %in% c("(Intercept)", "sigma"), drop = FALSE]
# P(|beta| > eps | y): probabilità a posteriori che coeff di regressione sia “sufficientemente lontano da 0”
eps <- 0.1  # in scala standardizzata: 0.1 è un effetto "piccolo ma reale"
p_big <- colMeans(abs(B) > eps) # media per colonna dei TRUE/FALSE (1/0): circa probabilità a posteriori che beta sia > soglia
# Selezione:
selected <- names(sort(p_big, decreasing = TRUE))[1:50]
X_red <- Xsc[, selected, drop = FALSE]
X_red <- X[, selected, drop = FALSE]
post <- as.matrix(fit_hs)  # Righe = campioni MCMC (tutte le chain concatenate); Colonne = coefficienti dei predittori
# nomi predittori così come sono in Xsc
x_names <- colnames(Xsc)
# quali coefficienti sono effettivamente presenti in post (Stan può droppare colonne)
present <- intersect(x_names, colnames(post))
if (length(present) == 0) stop("Nessun coefficiente di X trovato in 'post'")
post
x_names
colnames(post)
B <- post[, !colnames(post) %in% c("(Intercept)", "sigma"), drop = FALSE]
B
p_big
selected
# ora questa riga non può più fallire
X_red <- post[, selected, drop = FALSE]
X_red <- post[, selected, drop = FALSE]
X_red
selected
X_red <- as.matrix(df[, selected, drop = FALSE])
post <- as.matrix(fit_hs)  # Righe = campioni MCMC (tutte le chain concatenate); Colonne = coefficienti dei predittori
B <- post[, !colnames(post) %in% c("(Intercept)", "sigma"), drop = FALSE]
B_names <- colnames(B)
# rimuovi il prefisso X_red
B_names_new <- sub("^X_red", "", B_names)
colnames(B) <- B_names_new
# P(|beta| > eps | y): probabilità a posteriori che coeff di regressione sia “sufficientemente lontano da 0”
eps <- 0.1  # in scala standardizzata: 0.1 è un effetto "piccolo ma reale"
p_big <- colMeans(abs(B) > eps) # media per colonna dei TRUE/FALSE (1/0): circa probabilità a posteriori che beta sia > soglia
# Selezione:
selected <- names(sort(p_big, decreasing = TRUE))[1:50]
X_red <- Xsc[, selected, drop = FALSE] # il problema è che mi si sono sballati tutti i nomi delle colonne dopo aver usato STAN che quindi non coincidono più con quelli di Xsc (all'inizio del nome ha aggiunto X_red)
X_red
selected
X
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin_with_screening.R", echo = TRUE)
plot(res.bayes@graph)
plot(res_bayes@graph)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin_with_screening.R", echo = TRUE)
library(hdi)
library(pcalg)
library(Rgraphviz)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/personalized_my_skeleton_senza_stable_fast.R")
data(riboflavin)
X <- riboflavin$x   # matrice delle covariate
y <- riboflavin$y   # vettore delle risposte
dataset = c(X,y)
dim(dataset)
XX = c(X,y)
XX = cbind(X,y)
dim(XX)
XX = cbind(Xsc,ysc)
q = ncol(X)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
adj <- as(grafo, "matrix")
target_node <- "logRiboflavin"
neigh <- if(target_node %in% rownames(adj_B)) {
names(which(adj_B[target_node, ] == 1))
} else { character(0) }
target_node <- "logRiboflavin"
neigh <- if(target_node %in% rownames(adj)) {
names(which(adj_B[target_node, ] == 1))
} else { character(0) }
neigh2 <- if(neigh %in% rownames(adj_B)) {
names(which(adj_B[neigh_B, ] == 1))
} else { character(0) }
neigh2 <- if(neigh %in% rownames(adj)) {
names(which(adj_B[neigh_B, ] == 1))
} else { character(0) }
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
neigh
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
neigh
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
neigh
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
plot(skltn.bayes@graph)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
X
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
dim(data_sc)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
data(riboflavin)
X <- as.matrix(riboflavin$x)   # matrice delle covariate
y <- as.numeric(riboflavin$y)   # vettore delle risposte
Xsc <- scale(as.matrix(X))
ysc <- scale(as.numeric(y))
data = cbind(Xsc[,1:80],ysc)
data
X
colnames(data)[ncol(data)] <- "Riboflavin"
data_sc = scale(data)
data_sc
data(riboflavin)
X <- as.matrix(riboflavin$x)   # matrice delle covariate
y <- as.numeric(riboflavin$y)   # vettore delle risposte
data = cbind(X[,1:80],y)
data_sc = scale(data)
data
data_sc
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin.R", echo = TRUE)
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin_with_screening.R", echo = TRUE)
target_node <- "logRiboflavin"
neigh <- if(target_node %in% rownames(adj)) {
names(which(adj[target_node, ] == 1))
} else { character(0) }
neigh
source("C:/Users/arian/Desktop/Magistrale/Primo anno/Bayesian Statistics/Progetto/test_dataset_riboflavin_with_screening.R", echo = TRUE)
neigh_B
neigh <- if(neigh_B %in% rownames(adj)) {
names(which(adj[neigh_B, ] == 1))
} else { character(0) }
neigh
source("~/.active-rstudio-document", echo = TRUE)
neigh
source("~/.active-rstudio-document", echo = TRUE)
neigh
neighborhood()
